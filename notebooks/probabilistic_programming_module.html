
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Probabilistic Programming Module &#8212; kessler 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=f9c1cefe"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/probabilistic_programming_module';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API" href="../api.html" />
    <link rel="prev" title="LSTM training" href="LSTM_training.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/kessler_logo.png" class="logo__image only-light" alt="kessler 1.0.0 documentation - Home"/>
    <script>document.write(`<img src="../_static/kessler_logo.png" class="logo__image only-dark" alt="kessler 1.0.0 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../capabilities.html">Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../tutorials.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basics.html">Basics: loading CDMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdms_analysis_and_plotting.html">Analyze and plot loaded CDMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting Functionalities</a></li>
<li class="toctree-l2"><a class="reference internal" href="kelvins_dataset.html">Data Loading</a></li>


<li class="toctree-l2"><a class="reference internal" href="LSTM_training.html">LSTM training</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Probabilistic Programming Module</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.cdm.html">kessler.cdm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.data.html">kessler.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.event.html">kessler.event</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.model.html">kessler.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.nn.html">kessler.nn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.observation_model.html">kessler.observation_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.plot.html">kessler.plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/kessler.util.html">kessler.util</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/kesslerlib/kessler/master?urlpath=lab/tree/doc/notebooks/probabilistic_programming_module.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kesslerlib/kessler" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kesslerlib/kessler/issues/new?title=Issue%20on%20page%20%2Fnotebooks/probabilistic_programming_module.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/probabilistic_programming_module.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Probabilistic Programming Module</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="probabilistic-programming-module">
<h1>Probabilistic Programming Module<a class="headerlink" href="#probabilistic-programming-module" title="Link to this heading">#</a></h1>
<p>Here, we discuss how to use the probabilistic programming module to synthetically generate CDMs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">kessler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyro</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dsgp4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#we seed everything for reproducibility</span>
<span class="n">pyro</span><span class="o">.</span><span class="n">set_rng_seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1">#we define the observing instruments</span>
<span class="c1">#GNSS first:</span>
<span class="n">gnss_cov_rtn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1.115849341564346</span><span class="p">,</span> <span class="mf">0.059309835843067</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="n">instrument_characteristics_gnss</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;bias_xyz&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]),</span> <span class="s1">&#39;covariance_rtn&#39;</span><span class="p">:</span> <span class="n">gnss_cov_rtn</span><span class="p">}</span>
<span class="n">gnss</span> <span class="o">=</span> <span class="n">kessler</span><span class="o">.</span><span class="n">GNSS</span><span class="p">(</span><span class="n">instrument_characteristics_gnss</span><span class="p">)</span>

<span class="c1">#and then radar:</span>
<span class="n">radar_cov_rtn</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.9628939405514678</span><span class="p">,</span> <span class="mf">2.2307686944695706</span><span class="p">,</span> <span class="mf">0.9660907831563862</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="n">instrument_characteristics_radar</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;bias_xyz&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]),</span> <span class="s1">&#39;covariance_rtn&#39;</span><span class="p">:</span> <span class="n">radar_cov_rtn</span><span class="p">}</span>
<span class="n">radar</span> <span class="o">=</span> <span class="n">kessler</span><span class="o">.</span><span class="n">Radar</span><span class="p">(</span><span class="n">instrument_characteristics_radar</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tles</span><span class="o">=</span><span class="n">dsgp4</span><span class="o">.</span><span class="n">tle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;tles_sample_population.txt&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tles</span><span class="p">)</span><span class="si">}</span><span class="s2"> TLEs&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>loaded 20 TLEs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># tles=dsgp4.tle.load(&#39;tles_sample_population.txt&#39;)</span>

<span class="c1"># tles_filtered=[]</span>
<span class="c1"># for tle in tqdm(tles):</span>
<span class="c1">#     try: </span>
<span class="c1">#         dsgp4.initialize_tle(tle)</span>
<span class="c1">#         if tle.apogee_alt()&lt;560*1e3:</span>
<span class="c1">#             tles_filtered.append(tle)</span>
<span class="c1">#     except:</span>
<span class="c1">#         continue</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">conjunction_model</span> <span class="o">=</span> <span class="n">kessler</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ConjunctionSimplified</span><span class="p">(</span><span class="n">time0</span><span class="o">=</span><span class="mf">60727.13899462018</span><span class="p">,</span>
                                                        <span class="c1"># max_duration_days=7.0,</span>
                                                        <span class="c1"># time_resolution=600000.0,</span>
                                                        <span class="c1"># time_upsample_factor=100,</span>
                                                        <span class="n">miss_dist_threshold</span><span class="o">=</span><span class="mf">5000.0</span><span class="p">,</span>
                                                        <span class="n">prior_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                                        <span class="n">t_prob_new_obs</span><span class="o">=</span><span class="mf">0.96</span><span class="p">,</span>
                                                        <span class="n">c_prob_new_obs</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                                                        <span class="n">cdm_update_every_hours</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span>
                                                        <span class="n">mc_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                                        <span class="n">mc_upsample_factor</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                                        <span class="n">pc_method</span><span class="o">=</span><span class="s1">&#39;MC&#39;</span><span class="p">,</span>
                                                        <span class="n">collision_threshold</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
                                                        <span class="c1"># likelihood_t_stddev=[371.068006, 0.0999999999, 0.172560879],</span>
                                                        <span class="c1"># likelihood_c_stddev=[371.068006, 0.0999999999, 0.172560879],</span>
                                                        <span class="n">likelihood_time_to_tca_stddev</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                        <span class="n">t_observing_instruments</span><span class="o">=</span><span class="p">[</span><span class="n">gnss</span><span class="p">],</span>
                                                        <span class="n">c_observing_instruments</span><span class="o">=</span><span class="p">[</span><span class="n">radar</span><span class="p">],</span>
                                                        <span class="n">tles</span><span class="o">=</span><span class="n">tles</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace</span><span class="p">,</span><span class="n">iterations</span><span class="o">=</span><span class="n">conjunction_model</span><span class="o">.</span><span class="n">get_conjunction</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/ga00693/Develop/kessler/kessler/model.py:765: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  pyro.deterministic(&#39;conj&#39;,torch.tensor(conj))
/Users/ga00693/Develop/kessler/kessler/util.py:85: UserWarning: Using torch.cross without specifying the dim arg is deprecated.
Please either pass the dim explicitly or simply use torch.linalg.cross.
The default value of dim will change to agree with that of linalg.cross in a future release. (Triggered internally at /Users/runner/miniforge3/conda-bld/libtorch_1738206012956/work/aten/src/ATen/native/Cross.cpp:66.)
  h_vec = torch.cross(r_vec, v_vec)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>After 1170 iterations, generated event with 2 CDMs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s1">&#39;cdms&#39;</span><span class="p">][</span><span class="s1">&#39;infer&#39;</span><span class="p">][</span><span class="s1">&#39;cdms&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[CCSDS_CDM_VERS                        = 1.0
 CREATION_DATE                         = 2025-02-21T03:20:09.135184
 ORIGINATOR                            = KESSLER_SOFTWARE
 MESSAGE_ID                            = KESSLER_SOFTWARE_ac66059e-20e6-11f0-b2ee-f2a9f71f7e1a
 TCA                                   = 2025-02-22T01:17:28.408663
 MISS_DISTANCE                         = 141514.9960370336
 RELATIVE_SPEED                        = 8783.071096663718
 RELATIVE_POSITION_R                   = -3769.8761935982398
 RELATIVE_POSITION_T                   = -110791.09624826182
 RELATIVE_POSITION_N                   = -87963.71484285413
 RELATIVE_VELOCITY_R                   = -144.7709891581174
 RELATIVE_VELOCITY_T                   = -5424.100602146948
 RELATIVE_VELOCITY_N                   = -6906.555719570857
 COLLISION_PROBABILITY                 = 0.0
 COLLISION_PROBABILITY_METHOD          = MC
 OBJECT                                = OBJECT1
 OBJECT_DESIGNATOR                     = 76126AP
 CATALOG_NAME                          = 9827
 OBJECT_NAME                           = COSMOS 886 DEB
 INTERNATIONAL_DESIGNATOR              = 76126AP
 EPHEMERIS_NAME                        = NONE
 COVARIANCE_METHOD                     = CALCULATED
 MANEUVERABLE                          = N/A
 ORBIT_CENTER                          = EARTH
 REF_FRAME                             = ITRF
 X                                     = 2980.1734541932515
 Y                                     = -5181.782698754123
 Z                                     = -3422.116689930527
 X_DOT                                 = 4.425575967702924
 Y_DOT                                 = -1.3655090728792418
 Z_DOT                                 = 5.7673902574303915
 CR_R                                  = 434.5847746412686
 CT_R                                  = 3804.230266317108
 CT_T                                  = 41269.012800060416
 CN_R                                  = -224.26822649455545
 CN_T                                  = -3739.194423008724
 CN_N                                  = 4893.388541408624
 CRDOT_R                               = -2.690240978331646
 CRDOT_T                               = -32.45608595843143
 CRDOT_N                               = 3.3748910113664388
 CRDOT_RDOT                            = 0.026616660879604667
 CTDOT_R                               = -0.45587521823581134
 CTDOT_T                               = -3.891974449268055
 CTDOT_N                               = 0.21602245879137436
 CTDOT_RDOT                            = 0.002711690719702106
 CTDOT_TDOT                            = 0.000479432666082355
 CNDOT_R                               = 0.27513941996415164
 CNDOT_T                               = 0.4561951334680935
 CNDOT_N                               = -0.44165624627125066
 CNDOT_RDOT                            = 0.0004400365334853134
 CNDOT_TDOT                            = -0.0003127338855863759
 CNDOT_NDOT                            = 0.004822710541832547
 OBJECT                                = OBJECT2
 OBJECT_DESIGNATOR                     = 65082PT
 CATALOG_NAME                          = 3462
 OBJECT_NAME                           = TITAN 3C TRANSTAGE DEB
 INTERNATIONAL_DESIGNATOR              = 65082PT
 EPHEMERIS_NAME                        = NONE
 COVARIANCE_METHOD                     = CALCULATED
 MANEUVERABLE                          = N/A
 ORBIT_CENTER                          = EARTH
 REF_FRAME                             = ITRF
 X                                     = 2972.4172682119224
 Y                                     = -5103.530721008279
 Z                                     = -3539.772814553296
 X_DOT                                 = 5.826757151768794
 Y_DOT                                 = 4.085711393314795
 Z_DOT                                 = -0.9752519996834083
 CR_R                                  = 15.608895194536064
 CT_R                                  = -1831.7454009406745
 CT_T                                  = 387066.15903594147
 CN_R                                  = 71.5596813096827
 CN_T                                  = -6122.2782569260735
 CN_N                                  = 5424.209709946298
 CRDOT_R                               = 2.1418685416237584
 CRDOT_T                               = -416.38358827942716
 CRDOT_N                               = 8.17067859275866
 CRDOT_RDOT                            = 0.45361166277724996
 CTDOT_R                               = -0.005166751853750279
 CTDOT_T                               = -0.1424221310036492
 CTDOT_N                               = -0.019218390871709318
 CTDOT_RDOT                            = 1.609E-05
 CTDOT_TDOT                            = 5.202E-06
 CNDOT_R                               = 0.06170571196677281
 CNDOT_T                               = -8.629383890813989
 CNDOT_N                               = 1.1567101080406283
 CNDOT_RDOT                            = 0.010208457878684038
 CNDOT_TDOT                            = -1.756E-05
 CNDOT_NDOT                            = 0.0021928221709182245,
 CCSDS_CDM_VERS                        = 1.0
 CREATION_DATE                         = 2025-02-21T11:20:08.694966
 ORIGINATOR                            = KESSLER_SOFTWARE
 MESSAGE_ID                            = KESSLER_SOFTWARE_adc65ed4-20e6-11f0-b2ee-f2a9f71f7e1a
 TCA                                   = 2025-02-22T01:17:28.408663
 MISS_DISTANCE                         = 119296.4071367849
 RELATIVE_SPEED                        = 8781.77597072965
 RELATIVE_POSITION_R                   = -3392.400548990203
 RELATIVE_POSITION_T                   = -79317.283331336
 RELATIVE_POSITION_N                   = -89044.33131422414
 RELATIVE_VELOCITY_R                   = -154.91187193411943
 RELATIVE_VELOCITY_T                   = -5422.481073457308
 RELATIVE_VELOCITY_N                   = -6905.960506693898
 COLLISION_PROBABILITY                 = 0.0
 COLLISION_PROBABILITY_METHOD          = MC
 OBJECT                                = OBJECT1
 OBJECT_DESIGNATOR                     = 76126AP
 CATALOG_NAME                          = 9827
 OBJECT_NAME                           = COSMOS 886 DEB
 INTERNATIONAL_DESIGNATOR              = 76126AP
 EPHEMERIS_NAME                        = NONE
 COVARIANCE_METHOD                     = CALCULATED
 MANEUVERABLE                          = N/A
 ORBIT_CENTER                          = EARTH
 REF_FRAME                             = ITRF
 X                                     = 2961.416138954747
 Y                                     = -5176.42090647565
 Z                                     = -3446.5166602514805
 X_DOT                                 = 4.441367932633197
 Y_DOT                                 = -1.3893739558637068
 Z_DOT                                 = 5.749634804852701
 CR_R                                  = 418.4789881653135
 CT_R                                  = 2833.654900508839
 CT_T                                  = 26275.07871526111
 CN_R                                  = 235.96450630189815
 CN_T                                  = 1379.1837684683846
 CN_N                                  = 3824.354403059597
 CRDOT_R                               = -1.629021196870671
 CRDOT_T                               = -18.917640141448356
 CRDOT_N                               = -0.6906003255748716
 CRDOT_RDOT                            = 0.015134294118617029
 CTDOT_R                               = -0.44696031062349284
 CTDOT_T                               = -2.9384291761156875
 CTDOT_N                               = -0.2522263711844156
 CTDOT_RDOT                            = 0.001641663225350465
 CTDOT_TDOT                            = 0.0004784788899478311
 CNDOT_R                               = 0.15032615582479048
 CNDOT_T                               = 0.0059359771572660164
 CNDOT_N                               = -0.3262798823098171
 CNDOT_RDOT                            = 0.0004967254843707441
 CNDOT_TDOT                            = -0.00017283616485068076
 CNDOT_NDOT                            = 0.005746080835028397
 OBJECT                                = OBJECT2
 OBJECT_DESIGNATOR                     = 65082PT
 CATALOG_NAME                          = 3462
 OBJECT_NAME                           = TITAN 3C TRANSTAGE DEB
 INTERNATIONAL_DESIGNATOR              = 65082PT
 EPHEMERIS_NAME                        = NONE
 COVARIANCE_METHOD                     = CALCULATED
 MANEUVERABLE                          = N/A
 ORBIT_CENTER                          = EARTH
 REF_FRAME                             = ITRF
 X                                     = 2973.071864839906
 Y                                     = -5103.077176433223
 Z                                     = -3539.878719318852
 X_DOT                                 = 5.826399482002183
 Y_DOT                                 = 4.0863283565475435
 Z_DOT                                 = -0.9747953563722136
 CR_R                                  = 19.416112754758714
 CT_R                                  = -1063.96729664468
 CT_T                                  = 122541.70103023999
 CN_R                                  = -35.02940219476802
 CN_T                                  = 1550.9822755102928
 CN_N                                  = 5255.002744568752
 CRDOT_R                               = 1.2925239374152526
 CRDOT_T                               = -126.57004812480902
 CRDOT_N                               = -2.22107658156981
 CRDOT_RDOT                            = 0.1356785119000294
 CTDOT_R                               = -0.010480352857442607
 CTDOT_T                               = 0.30203170115238487
 CTDOT_N                               = 0.03313019924386015
 CTDOT_RDOT                            = -0.00046144760169145884
 CTDOT_TDOT                            = 7.133E-06
 CNDOT_R                               = -0.01550631317382298
 CNDOT_T                               = -0.7484418552935522
 CNDOT_N                               = 1.171583503661754
 CNDOT_RDOT                            = 0.0008530656635604496
 CNDOT_TDOT                            = 1.209E-05
 CNDOT_NDOT                            = 0.0018826631138264438]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#let&#39;s save all cdms to kvn files:</span>
<span class="c1">#for i in range(len(trace.nodes[&#39;cdms&#39;][&#39;infer&#39;][&#39;cdms&#39;])):    </span>
<span class="c1">#    trace.nodes[&#39;cdms&#39;][&#39;infer&#39;][&#39;cdms&#39;][i].save(f&#39;event2_{i}.kvn&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="LSTM_training.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">LSTM training</p>
      </div>
    </a>
    <a class="right-next"
       href="../api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Giacomo Acciarini, Atılım Güneş Baydin, Francesco Pinto
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2020-2025, Kessler contributors.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>